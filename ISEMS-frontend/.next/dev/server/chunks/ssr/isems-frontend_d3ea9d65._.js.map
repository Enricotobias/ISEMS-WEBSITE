{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/icoto/OneDrive%20-%20Universitas%20Diponegoro/Documents/ISEMS/isems-frontend/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst Card = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    className={cn(\r\n      \"rounded-xl border bg-white shadow-sm transition-all hover:shadow-md\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nCard.displayName = \"Card\"\r\n\r\nconst CardHeader = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\r\n    {...props}\r\n  />\r\n))\r\nCardHeader.displayName = \"CardHeader\"\r\n\r\nconst CardTitle = React.forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLAttributes<HTMLHeadingElement>\r\n>(({ className, ...props }, ref) => (\r\n  <h3\r\n    ref={ref}\r\n    className={cn(\"font-semibold leading-none tracking-tight text-xl\", className)}\r\n    {...props}\r\n  />\r\n))\r\nCardTitle.displayName = \"CardTitle\"\r\n\r\nconst CardDescription = React.forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLAttributes<HTMLParagraphElement>\r\n>(({ className, ...props }, ref) => (\r\n  <p\r\n    ref={ref}\r\n    className={cn(\"text-sm text-gray-500\", className)}\r\n    {...props}\r\n  />\r\n))\r\nCardDescription.displayName = \"CardDescription\"\r\n\r\nconst CardContent = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\r\n))\r\nCardContent.displayName = \"CardContent\"\r\n\r\nconst CardFooter = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    className={cn(\"flex items-center p-6 pt-0\", className)}\r\n    {...props}\r\n  />\r\n))\r\nCardFooter.displayName = \"CardFooter\"\r\n\r\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA;AACA;;;;AAEA,MAAM,qBAAO,wOAAgB,CAG3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,mQAAC;QACC,KAAK;QACL,WAAW,IAAA,uIAAE,EACX,uEACA;QAED,GAAG,KAAK;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,wOAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,mQAAC;QACC,KAAK;QACL,WAAW,IAAA,uIAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,wOAAgB,CAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,mQAAC;QACC,KAAK;QACL,WAAW,IAAA,uIAAE,EAAC,qDAAqD;QAClE,GAAG,KAAK;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,wOAAgB,CAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,mQAAC;QACC,KAAK;QACL,WAAW,IAAA,uIAAE,EAAC,yBAAyB;QACtC,GAAG,KAAK;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,wOAAgB,CAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,mQAAC;QAAI,KAAK;QAAK,WAAW,IAAA,uIAAE,EAAC,YAAY;QAAa,GAAG,KAAK;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,wOAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,mQAAC;QACC,KAAK;QACL,WAAW,IAAA,uIAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG"}},
    {"offset": {"line": 89, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/icoto/OneDrive%20-%20Universitas%20Diponegoro/Documents/ISEMS/isems-frontend/components/dashboard/device-status-card.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { useDeviceStatus, useTelemetry } from '@/hooks'\r\nimport { \r\n  Power, \r\n  Thermometer, \r\n  Wind, \r\n  Wifi,\r\n  AlertTriangle,\r\n  Clock\r\n} from 'lucide-react'\r\nimport { \r\n  formatTemperature, \r\n  getModeIcon, \r\n  getModeColor,\r\n  getFanIcon,\r\n  getRSSIQuality,\r\n  getStatusColor,\r\n  formatRelativeTime,\r\n  getErrorDescription\r\n} from '@/lib/utils'\r\nimport { cn } from '@/lib/utils'\r\n\r\ninterface DeviceStatusCardProps {\r\n  deviceId: string\r\n  deviceName: string\r\n}\r\n\r\nexport function DeviceStatusCard({ deviceId, deviceName }: DeviceStatusCardProps) {\r\n  const { status, isOnline, lastDisconnect, offlineDuration } = useDeviceStatus(deviceId)\r\n  const { latest, isLoading } = useTelemetry(deviceId, 1)\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <Card className=\"animate-pulse\">\r\n        <CardHeader>\r\n          <div className=\"h-6 w-32 bg-gray-200 rounded\" />\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-3\">\r\n            <div className=\"h-4 bg-gray-200 rounded w-full\" />\r\n            <div className=\"h-4 bg-gray-200 rounded w-3/4\" />\r\n            <div className=\"h-4 bg-gray-200 rounded w-1/2\" />\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    )\r\n  }\r\n\r\n  const hasError = latest?.error_code && latest.error_code !== 'E0'\r\n  const rssiQuality = latest ? getRSSIQuality(latest.wifi_rssi) : null\r\n\r\n  return (\r\n    <Card className={cn(\r\n      \"transition-all hover:shadow-lg\",\r\n      !isOnline && \"opacity-60\"\r\n    )}>\r\n      <CardHeader>\r\n        <div className=\"flex items-center justify-between\">\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <div className={cn(\r\n              \"h-3 w-3 rounded-full\",\r\n              getStatusColor(status)\r\n            )} />\r\n            {deviceName}\r\n          </CardTitle>\r\n          \r\n          {/* Status Badge */}\r\n          <div className={cn(\r\n            \"rounded-full px-3 py-1 text-xs font-medium\",\r\n            isOnline \r\n              ? \"bg-green-50 text-green-600\" \r\n              : \"bg-gray-100 text-gray-600\"\r\n          )}>\r\n            {status.toUpperCase()}\r\n          </div>\r\n        </div>\r\n        \r\n        {/* Last Seen Info (jika offline) */}\r\n        {!isOnline && latest && (\r\n          <div className=\"mt-2 flex items-center gap-2 text-xs text-gray-500\">\r\n            <Clock className=\"h-3 w-3\" />\r\n            <span>Last seen: {formatRelativeTime(latest.timestamp)}</span>\r\n          </div>\r\n        )}\r\n      </CardHeader>\r\n\r\n      <CardContent className=\"space-y-4\">\r\n        {/* Power Status */}\r\n        <div className=\"flex items-center justify-between rounded-lg bg-gray-50 p-3\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <Power className={cn(\r\n              \"h-5 w-5\",\r\n              latest?.power ? \"text-green-500\" : \"text-gray-400\"\r\n            )} />\r\n            <span className=\"text-sm font-medium\">Power</span>\r\n          </div>\r\n          <span className={cn(\r\n            \"text-sm font-semibold\",\r\n            latest?.power ? \"text-green-600\" : \"text-gray-600\"\r\n          )}>\r\n            {latest?.power ? 'ON' : 'OFF'}\r\n          </span>\r\n        </div>\r\n\r\n        {/* Temperature */}\r\n        {latest && (\r\n          <div className=\"grid grid-cols-2 gap-3\">\r\n            <div className=\"flex items-center gap-2 rounded-lg bg-blue-50 p-3\">\r\n              <Thermometer className=\"h-5 w-5 text-blue-500\" />\r\n              <div>\r\n                <div className=\"text-xs text-gray-600\">Temperature</div>\r\n                <div className=\"text-lg font-bold text-blue-600\">\r\n                  {formatTemperature(latest.current_temp)}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Mode */}\r\n            <div className={cn(\r\n              \"flex items-center gap-2 rounded-lg p-3\",\r\n              getModeColor(latest.mode)\r\n            )}>\r\n              <span className=\"text-2xl\">{getModeIcon(latest.mode)}</span>\r\n              <div>\r\n                <div className=\"text-xs text-gray-600\">Mode</div>\r\n                <div className=\"text-sm font-semibold\">\r\n                  {latest.mode}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Fan Speed & WiFi */}\r\n        {latest && (\r\n          <div className=\"grid grid-cols-2 gap-3\">\r\n            <div className=\"flex items-center gap-2 rounded-lg bg-gray-50 p-3\">\r\n              <Wind className=\"h-5 w-5 text-gray-500\" />\r\n              <div>\r\n                <div className=\"text-xs text-gray-600\">Fan Speed</div>\r\n                <div className=\"text-sm font-semibold\">\r\n                  {latest.fan_speed}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {rssiQuality && (\r\n              <div className=\"flex items-center gap-2 rounded-lg bg-gray-50 p-3\">\r\n                <Wifi className={cn(\"h-5 w-5\", rssiQuality.color)} />\r\n                <div>\r\n                  <div className=\"text-xs text-gray-600\">Signal</div>\r\n                  <div className={cn(\"text-sm font-semibold\", rssiQuality.color)}>\r\n                    {rssiQuality.label}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Error Alert */}\r\n        {hasError && latest && (\r\n          <div className=\"flex items-start gap-2 rounded-lg bg-red-50 p-3 text-red-600\">\r\n            <AlertTriangle className=\"h-5 w-5 flex-shrink-0 mt-0.5\" />\r\n            <div className=\"flex-1\">\r\n              <div className=\"text-sm font-semibold\">\r\n                Error: {latest.error_code}\r\n              </div>\r\n              <div className=\"text-xs text-red-500\">\r\n                {getErrorDescription(latest.error_code)}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AAZA;;;;;;;AA6BO,SAAS,iBAAiB,EAAE,QAAQ,EAAE,UAAU,EAAyB;IAC9E,MAAM,EAAE,MAAM,EAAE,QAAQ,EAAE,cAAc,EAAE,eAAe,EAAE,GAAG,IAAA,sJAAe,EAAC;IAC9E,MAAM,EAAE,MAAM,EAAE,SAAS,EAAE,GAAG,IAAA,mJAAY,EAAC,UAAU;IAErD,IAAI,WAAW;QACb,qBACE,mQAAC,sJAAI;YAAC,WAAU;;8BACd,mQAAC,4JAAU;8BACT,cAAA,mQAAC;wBAAI,WAAU;;;;;;;;;;;8BAEjB,mQAAC,6JAAW;8BACV,cAAA,mQAAC;wBAAI,WAAU;;0CACb,mQAAC;gCAAI,WAAU;;;;;;0CACf,mQAAC;gCAAI,WAAU;;;;;;0CACf,mQAAC;gCAAI,WAAU;;;;;;;;;;;;;;;;;;;;;;;IAKzB;IAEA,MAAM,WAAW,QAAQ,cAAc,OAAO,UAAU,KAAK;IAC7D,MAAM,cAAc,SAAS,IAAA,mJAAc,EAAC,OAAO,SAAS,IAAI;IAEhE,qBACE,mQAAC,sJAAI;QAAC,WAAW,IAAA,uIAAE,EACjB,kCACA,CAAC,YAAY;;0BAEb,mQAAC,4JAAU;;kCACT,mQAAC;wBAAI,WAAU;;0CACb,mQAAC,2JAAS;gCAAC,WAAU;;kDACnB,mQAAC;wCAAI,WAAW,IAAA,uIAAE,EAChB,wBACA,IAAA,mJAAc,EAAC;;;;;;oCAEhB;;;;;;;0CAIH,mQAAC;gCAAI,WAAW,IAAA,uIAAE,EAChB,8CACA,WACI,+BACA;0CAEH,OAAO,WAAW;;;;;;;;;;;;oBAKtB,CAAC,YAAY,wBACZ,mQAAC;wBAAI,WAAU;;0CACb,mQAAC,kOAAK;gCAAC,WAAU;;;;;;0CACjB,mQAAC;;oCAAK;oCAAY,IAAA,uJAAkB,EAAC,OAAO,SAAS;;;;;;;;;;;;;;;;;;;0BAK3D,mQAAC,6JAAW;gBAAC,WAAU;;kCAErB,mQAAC;wBAAI,WAAU;;0CACb,mQAAC;gCAAI,WAAU;;kDACb,mQAAC,kOAAK;wCAAC,WAAW,IAAA,uIAAE,EAClB,WACA,QAAQ,QAAQ,mBAAmB;;;;;;kDAErC,mQAAC;wCAAK,WAAU;kDAAsB;;;;;;;;;;;;0CAExC,mQAAC;gCAAK,WAAW,IAAA,uIAAE,EACjB,yBACA,QAAQ,QAAQ,mBAAmB;0CAElC,QAAQ,QAAQ,OAAO;;;;;;;;;;;;oBAK3B,wBACC,mQAAC;wBAAI,WAAU;;0CACb,mQAAC;gCAAI,WAAU;;kDACb,mQAAC,oPAAW;wCAAC,WAAU;;;;;;kDACvB,mQAAC;;0DACC,mQAAC;gDAAI,WAAU;0DAAwB;;;;;;0DACvC,mQAAC;gDAAI,WAAU;0DACZ,IAAA,sJAAiB,EAAC,OAAO,YAAY;;;;;;;;;;;;;;;;;;0CAM5C,mQAAC;gCAAI,WAAW,IAAA,uIAAE,EAChB,0CACA,IAAA,iJAAY,EAAC,OAAO,IAAI;;kDAExB,mQAAC;wCAAK,WAAU;kDAAY,IAAA,gJAAW,EAAC,OAAO,IAAI;;;;;;kDACnD,mQAAC;;0DACC,mQAAC;gDAAI,WAAU;0DAAwB;;;;;;0DACvC,mQAAC;gDAAI,WAAU;0DACZ,OAAO,IAAI;;;;;;;;;;;;;;;;;;;;;;;;oBAQrB,wBACC,mQAAC;wBAAI,WAAU;;0CACb,mQAAC;gCAAI,WAAU;;kDACb,mQAAC,+NAAI;wCAAC,WAAU;;;;;;kDAChB,mQAAC;;0DACC,mQAAC;gDAAI,WAAU;0DAAwB;;;;;;0DACvC,mQAAC;gDAAI,WAAU;0DACZ,OAAO,SAAS;;;;;;;;;;;;;;;;;;4BAKtB,6BACC,mQAAC;gCAAI,WAAU;;kDACb,mQAAC,+NAAI;wCAAC,WAAW,IAAA,uIAAE,EAAC,WAAW,YAAY,KAAK;;;;;;kDAChD,mQAAC;;0DACC,mQAAC;gDAAI,WAAU;0DAAwB;;;;;;0DACvC,mQAAC;gDAAI,WAAW,IAAA,uIAAE,EAAC,yBAAyB,YAAY,KAAK;0DAC1D,YAAY,KAAK;;;;;;;;;;;;;;;;;;;;;;;;oBAS7B,YAAY,wBACX,mQAAC;wBAAI,WAAU;;0CACb,mQAAC,8PAAa;gCAAC,WAAU;;;;;;0CACzB,mQAAC;gCAAI,WAAU;;kDACb,mQAAC;wCAAI,WAAU;;4CAAwB;4CAC7B,OAAO,UAAU;;;;;;;kDAE3B,mQAAC;wCAAI,WAAU;kDACZ,IAAA,wJAAmB,EAAC,OAAO,UAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQtD"}},
    {"offset": {"line": 530, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/icoto/OneDrive%20-%20Universitas%20Diponegoro/Documents/ISEMS/isems-frontend/components/dashboard/temperature-chart.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card'\r\nimport { useTelemetry } from '@/hooks'\r\nimport { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Legend } from 'recharts'\r\nimport { formatTimeOnly } from '@/lib/utils'\r\nimport { TrendingUp } from 'lucide-react'\r\n\r\ninterface TemperatureChartProps {\r\n  deviceId: string\r\n  limit?: number\r\n}\r\n\r\nexport function TemperatureChart({ deviceId, limit = 50 }: TemperatureChartProps) {\r\n  const { logs, isLoading } = useTelemetry(deviceId, limit)\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <TrendingUp className=\"h-5 w-5\" />\r\n            Temperature Trend\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"flex h-80 items-center justify-center\">\r\n            <div className=\"text-gray-400\">Loading chart data...</div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    )\r\n  }\r\n\r\n  // Transform data untuk Recharts\r\n  const chartData = logs\r\n    .slice()\r\n    .reverse()\r\n    .map(log => ({\r\n      time: formatTimeOnly(log.timestamp),\r\n      temperature: log.current_temp,\r\n      power: log.power ? 1 : 0\r\n    }))\r\n\r\n  // === PERBAIKAN STATISTIK ===\r\n  // 1. Filter hanya data yang valid (angka)\r\n  const temps = logs\r\n    .map(l => Number(l.current_temp))\r\n    .filter(t => !isNaN(t) && t !== null);\r\n\r\n  // 2. Cek apakah array kosong untuk menghindari pembagian dengan nol (NaN)\r\n  const totalTemp = temps.reduce((a, b) => a + b, 0);\r\n  const avgTemp = temps.length > 0 ? totalTemp / temps.length : 0;\r\n  \r\n  // 3. Min/Max dengan fallback\r\n  const minTemp = temps.length > 0 ? Math.min(...temps) : 0;\r\n  const maxTemp = temps.length > 0 ? Math.max(...temps) : 0;\r\n\r\n  return (\r\n    <Card>\r\n      <CardHeader>\r\n        <CardTitle className=\"flex items-center gap-2\">\r\n          <TrendingUp className=\"h-5 w-5 text-blue-500\" />\r\n          Temperature Trend\r\n        </CardTitle>\r\n        <CardDescription>\r\n          Real-time temperature monitoring - Last {logs.length} readings\r\n        </CardDescription>\r\n        \r\n        {/* Statistics */}\r\n        <div className=\"mt-4 grid grid-cols-3 gap-4\">\r\n          <div className=\"rounded-lg bg-blue-50 p-3\">\r\n            <div className=\"text-xs text-gray-600\">Average</div>\r\n            <div className=\"text-lg font-bold text-blue-600\">\r\n              {/* FIX: Gunakan Math.round agar bulat tanpa koma */}\r\n              {Math.round(avgTemp)}째C\r\n            </div>\r\n          </div>\r\n          <div className=\"rounded-lg bg-green-50 p-3\">\r\n            <div className=\"text-xs text-gray-600\">Min</div>\r\n            <div className=\"text-lg font-bold text-green-600\">\r\n              {Math.round(minTemp)}째C\r\n            </div>\r\n          </div>\r\n          <div className=\"rounded-lg bg-red-50 p-3\">\r\n            <div className=\"text-xs text-gray-600\">Max</div>\r\n            <div className=\"text-lg font-bold text-red-600\">\r\n              {Math.round(maxTemp)}째C\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </CardHeader>\r\n\r\n      <CardContent>\r\n        <ResponsiveContainer width=\"100%\" height={300}>\r\n          <LineChart data={chartData}>\r\n            <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#f0f0f0\" />\r\n            <XAxis \r\n              dataKey=\"time\" \r\n              stroke=\"#888\"\r\n              style={{ fontSize: '12px' }}\r\n              tickMargin={10}\r\n            />\r\n            <YAxis \r\n              stroke=\"#888\"\r\n              style={{ fontSize: '12px' }}\r\n              domain={[16, 30]}\r\n              ticks={[16, 18, 20, 22, 24, 26, 28, 30]}\r\n            />\r\n            <Tooltip \r\n              contentStyle={{ \r\n                backgroundColor: 'white',\r\n                border: '1px solid #e5e7eb',\r\n                borderRadius: '8px',\r\n                padding: '8px 12px'\r\n              }}\r\n              formatter={(value: any, name: string) => {\r\n                if (name === 'temperature') return [`${value}째C`, 'Temperature']\r\n                if (name === 'power') return [value === 1 ? 'ON' : 'OFF', 'Power']\r\n                return [value, name]\r\n              }}\r\n            />\r\n            <Legend \r\n              wrapperStyle={{ paddingTop: '20px' }}\r\n              iconType=\"line\"\r\n            />\r\n            <Line \r\n              type=\"monotone\" \r\n              dataKey=\"temperature\" \r\n              stroke=\"#3b82f6\" \r\n              strokeWidth={2}\r\n              dot={{ fill: '#3b82f6', r: 3 }}\r\n              activeDot={{ r: 5 }}\r\n              name=\"Temperature\"\r\n            />\r\n          </LineChart>\r\n        </ResponsiveContainer>\r\n      </CardContent>\r\n    </Card>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 888, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/icoto/OneDrive%20-%20Universitas%20Diponegoro/Documents/ISEMS/isems-frontend/app/dashboard/page.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useDevices, useDeviceHealth } from '@/hooks' // Hook baru sudah ada\r\nimport { DeviceStatusCard } from '@/components/dashboard/device-status-card'\r\nimport { TemperatureChart } from '@/components/dashboard/temperature-chart'\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Button } from '@/components/ui/button'\r\nimport { RefreshCw, Plus, Activity, Clock, Stethoscope } from 'lucide-react' // Tambah Icon\r\nimport { useState } from 'react'\r\nimport { formatUptime, getHealthColor } from '@/lib/utils'\r\nimport { controlAPI } from '@/lib/api' // Import controlAPI\r\n\r\nexport default function DashboardPage() {\r\n  const { devices, isLoading, refresh } = useDevices()\r\n  const [refreshing, setRefreshing] = useState(false)\r\n  \r\n  // PERBAIKAN TYPO DI SINI:\r\n  const [isScanning, setIsScanning] = useState(false)\r\n\r\n  // Ambil Device ID pertama\r\n  const mainDeviceId = devices.length > 0 ? devices[0].device_id : ''\r\n  const { health, refresh: refreshHealth } = useDeviceHealth(mainDeviceId)\r\n\r\n  const handleRefresh = async () => {\r\n    setRefreshing(true)\r\n    await refresh()\r\n    await refreshHealth()\r\n    setTimeout(() => setRefreshing(false), 1000)\r\n  }\r\n\r\n  // === FUNGSI SCAN ===\r\n  const handleScanHealth = async () => {\r\n    if (!mainDeviceId) return;\r\n    \r\n    setIsScanning(true);\r\n    try {\r\n      // 1. Kirim Perintah ke ESP32\r\n      await controlAPI.requestDiagnostics(mainDeviceId);\r\n      \r\n      // 2. Tunggu 2.5 detik\r\n      await new Promise(resolve => setTimeout(resolve, 2500));\r\n      \r\n      // 3. Refresh data\r\n      await refreshHealth();\r\n      \r\n    } catch (error) {\r\n      console.error(\"Scan failed\", error);\r\n    } finally {\r\n      setIsScanning(false);\r\n    }\r\n  }\r\n\r\n  const activeDevices = devices.filter(d => d.status === 'online')\r\n  const totalDevices = devices.length\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Page Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold text-gray-900\">Dashboard</h1>\r\n          <p className=\"text-gray-500\">\r\n            Monitor all your AC devices in real-time\r\n          </p>\r\n        </div>\r\n        <div className=\"flex gap-3\">\r\n          <Button \r\n            onClick={handleRefresh} \r\n            variant=\"outline\"\r\n            isLoading={refreshing}\r\n          >\r\n            <RefreshCw className={`mr-2 h-4 w-4 ${refreshing ? 'animate-spin' : ''}`} />\r\n            Refresh\r\n          </Button>\r\n          <Button>\r\n            <Plus className=\"mr-2 h-4 w-4\" />\r\n            Add Device\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats Overview */}\r\n      <div className=\"grid gap-6 md:grid-cols-3\">\r\n        {/* Card 1 */}\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-gray-600\">\r\n              Total Devices\r\n            </CardTitle>\r\n            <Activity className=\"h-4 w-4 text-gray-400\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-3xl font-bold\">{totalDevices}</div>\r\n            <p className=\"text-xs text-gray-500 mt-1\">\r\n              {activeDevices.length} active, {totalDevices - activeDevices.length} offline\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Card 2 */}\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-gray-600\">\r\n              Online Rate\r\n            </CardTitle>\r\n            <div className=\"h-3 w-3 rounded-full bg-green-500 animate-pulse\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-3xl font-bold text-green-600\">\r\n              {totalDevices > 0 \r\n                ? Math.round((activeDevices.length / totalDevices) * 100)\r\n                : 0}%\r\n            </div>\r\n            <p className=\"text-xs text-gray-500 mt-1\">\r\n              System running optimally\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Card 3: DEVICE HEALTH DENGAN TOMBOL SCAN */}\r\n        <Card className=\"relative overflow-hidden\">\r\n          <CardHeader className=\"flex flex-row items-center justify-between pb-2\">\r\n            <CardTitle className=\"text-sm font-medium text-gray-600\">\r\n              System Health\r\n            </CardTitle>\r\n            {/* Tombol Scan */}\r\n            <Button \r\n              variant=\"ghost\" \r\n              size=\"icon\" \r\n              className=\"h-6 w-6 -mr-2 hover:bg-blue-50\" \r\n              onClick={handleScanHealth}\r\n              disabled={isScanning || !mainDeviceId}\r\n              title=\"Scan Diagnostics\"\r\n            >\r\n              <Stethoscope className={`h-4 w-4 text-blue-500 ${isScanning ? 'animate-pulse' : ''}`} />\r\n            </Button>\r\n          </CardHeader>\r\n          <CardContent>\r\n            {health ? (\r\n              <>\r\n                <div className=\"flex items-end justify-between\">\r\n                  <div className={`text-3xl font-bold ${\r\n                    health.health_score > 80 ? 'text-green-600' : \r\n                    health.health_score > 50 ? 'text-yellow-600' : 'text-red-600'\r\n                  }`}>\r\n                    {health.health_score}%\r\n                  </div>\r\n                  {isScanning && (\r\n                    <span className=\"text-xs text-blue-500 animate-pulse mb-1 font-medium\">Scanning...</span>\r\n                  )}\r\n                </div>\r\n                \r\n                <div className=\"flex items-center gap-2 mt-1\">\r\n                  <span className={`text-xs font-medium px-2 py-0.5 rounded ${getHealthColor(health.health_status)}`}>\r\n                    {health.health_status}\r\n                  </span>\r\n                  <span className=\"text-xs text-gray-500 flex items-center gap-1\">\r\n                    <Clock className=\"h-3 w-3\" />\r\n                    {formatUptime(health.uptime_sec)}\r\n                  </span>\r\n                </div>\r\n              </>\r\n            ) : (\r\n              <div className=\"flex flex-col justify-between h-full\">\r\n                <div className=\"text-3xl font-bold text-gray-300\">--%</div>\r\n                <div className=\"flex items-center justify-between mt-1\">\r\n                   <p className=\"text-xs text-gray-400\">No data</p>\r\n                   <Button \r\n                     variant=\"link\" \r\n                     className=\"text-xs h-auto p-0 text-blue-500\"\r\n                     onClick={handleScanHealth}\r\n                     disabled={isScanning}\r\n                   >\r\n                     {isScanning ? 'Scanning...' : 'Scan Now'}\r\n                   </Button>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n          \r\n          {isScanning && (\r\n            <div className=\"absolute inset-0 bg-white/50 z-10 pointer-events-none\" />\r\n          )}\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Loading Devices */}\r\n      {isLoading && (\r\n        <div className=\"flex items-center justify-center h-64\">\r\n          <div className=\"text-center\">\r\n            <div className=\"h-12 w-12 animate-spin rounded-full border-4 border-blue-500 border-t-transparent mx-auto mb-4\" />\r\n            <p className=\"text-gray-500\">Loading devices...</p>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {!isLoading && devices.length > 0 && (\r\n        <>\r\n          <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\r\n            {devices.map((device) => (\r\n              <DeviceStatusCard\r\n                key={device.device_id}\r\n                deviceId={device.device_id}\r\n                deviceName={device.name}\r\n              />\r\n            ))}\r\n          </div>\r\n\r\n          <div className=\"grid gap-6 lg:grid-cols-2\">\r\n            {devices.slice(0, 2).map((device) => (\r\n              <TemperatureChart\r\n                key={device.device_id}\r\n                deviceId={device.device_id}\r\n              />\r\n            ))}\r\n          </div>\r\n        </>\r\n      )}\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}}]
}